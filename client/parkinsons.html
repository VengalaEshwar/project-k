<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Parkinson's Disease Prediction</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header>
        <div class="logo">
            <a href="index.html">
                <img src="logo.png" alt="NeuroPredict Logo">
            </a>
            <h1>Neurological Disease Prediction System</h1>
        </div>
        <nav>
            <ul>
                <li><a href="index.html" class="active">Home</a></li>
                <li><a href="alzheimers.html" class="active">Alzheimer's</a></li> 
                <li><a href="parkinsons.html">Parkinson's</a></li>
            </ul>
        </nav>
    </header>
    
    <section id="home" class="active">
        <div class="hero">
            <h2>Parkinson's Disease Prediction</h2>
            <button id="recordButton">Record</button>
            <button id="stopButton" disabled>Stop</button>
            <button id="uploadButton" disabled>Upload</button>
            <audio id="audioPlayback" controls></audio>
            <p id="result"></p>
            <script>
                    let mediaRecorder;
                    let audioChunks = [];
            
                    document.getElementById('recordButton').addEventListener('click', async () => {
                        let stream = await navigator.mediaDevices.getUserMedia({ audio: true });
                        mediaRecorder = new MediaRecorder(stream);
                        mediaRecorder.start();
            
                        mediaRecorder.addEventListener('dataavailable', event => {
                            audioChunks.push(event.data);
                        });
            
                        mediaRecorder.addEventListener('stop', () => {
                            const audioBlob = new Blob(audioChunks, { type: 'audio/wav' });
                            const audioUrl = URL.createObjectURL(audioBlob);
                            const audio = document.getElementById('audioPlayback');
                            audio.src = audioUrl;
            
                            document.getElementById('uploadButton').disabled = false;
                        });
            
                        document.getElementById('recordButton').disabled = true;
                        document.getElementById('stopButton').disabled = false;
                    });
            
                    document.getElementById('stopButton').addEventListener('click', () => {
                        mediaRecorder.stop();
                        document.getElementById('recordButton').disabled = false;
                        document.getElementById('stopButton').disabled = true;
                    });
            
                    document.getElementById('uploadButton').addEventListener('click', async () => {
                        const audioBlob = new Blob(audioChunks, { type: 'audio/wav' });
                        const formData = new FormData();
                        formData.append('audio', audioBlob, 'recorded_audio.wav');
            
                        fetch('http://127.0.0.1:3000/predictparkinsons', {
                            method: 'POST',
                            body: formData
                        })
                        .then(response => response.json())
                        .then(data => {
                            if (data.error) {
                                document.getElementById('result').innerText = 'Error: ' + data.error;
                            } else {
                                document.getElementById('result').innerText = 'Prediction: ' + data.prediction;
                            }
                        })
                        .catch(error => {
                            document.getElementById('result').innerText = 'Error: ' + error.message;
                        });
            
                        // Reset for next recording
                        audioChunks = [];
                        document.getElementById('uploadButton').disabled = true;
                    });
                </script>
            
        </div>
    </section>

    <footer>
        <div class="footer">
            <p>&copy; 2024 NeuroPredict. All rights reserved.</p>
        </div>
    </footer>
</body>
</html>
